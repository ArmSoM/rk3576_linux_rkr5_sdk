cc_defaults {
    name: "rkaiq-defaults",
}

rkaiq_version_defaults {
    name: "rkaiq-version-defaults-flags",
}

rkaiq_defaults {
    name: "rkaiq-defaults-flags",
}

bootstrap_go_package {
    name: "soong-operator",
    pkgPath: "android/soong/external/camera_engine_rkaiq",
    deps: [
            "blueprint",
            "blueprint-pathtools",
            "soong",
            "soong-android",
            "soong-cc",
            "soong-genrule",
        ],
    srcs: [
            "rkaiq.go",
            "rkaiq_getAlgosLib.go",
            "rkaiq_getAlgosMacros.go",
            "rkaiq_getSrcsFiles.go",
            "rkaiq_switchs.go",
            "rkaiq_getStaticLibSrcs.go",
        ],
    pluginFor: ["soong_build"],
}

subdirs = [
    "algos",
    "algos_camgroup",
    "iq_parser_v2",
]

cc_prebuilt_library_static {
    name: "libgenMeshLib",
    vendor: true,
    arch: {
        arm: {
            srcs: ["common/gen_mesh/android/genMesh_static_32bit/libgenMeshLib.a"],
        },
        arm64: {
            srcs: ["common/gen_mesh/android/genMesh_static_64bit/libgenMeshLib.a"],
        },
    },
}

cc_library_headers {
	name: "librkaiq_headers",
	export_include_dirs: ["include"],
	vendor_available: true,
}

cc_rkaiq_library_shared {
    name: "librkaiq",
    vendor: true,
    rtti: true,
    stl: "c++_static",

    defaults: [ "rkaiq-defaults", "rkaiq-defaults-flags", ],

    local_include_dirs: [
        ".",
        "xcore",
        "xcore/base",
        "common",
        "common/gen_mesh",
        "aiq_core",
        "algos",
        "hwi",
        "hwi/isp20",
        "hwi/isp21",
        "hwi/isp3x",
        "hwi/isp32",
        "hwi/isp39",
        "iq_parser",
        "iq_parser_v2",
        "uAPI",
        "uAPI/include",
        "uAPI2",
        "ipc_server",
        "include",
        "include/xcore",
        "include/xcore/base",
        "include/common",
        "include/common/mediactl",
        "include/algos",
        "include/iq_parser",
        "include/iq_parser_v2",
        "include/iq_parser_v2/j2s",
        "include/uAPI2",
        "include/ipc_server",
        "include/algos/amerge",
		"modules",
        "include/isp",
        "c_base",
        "ipc",
        "xcore_c",
        "aiq_core_c",
        "hwi_c",
    ],

    header_libs: [
        "gl_headers",
    ],

    shared_libs: [
        "libutils",
        "libcutils",
        "liblog",
    ],

    static_libs: [
        "libgenMeshLib",
        "libiq_parser_v2",
    ],

    cflags: [
        "-fPIC",
        "-Wall",
        "-Wno-error",
        "-Os",
        "-g",
        "-Wno-unused-value",
        "-Wno-unused-variable",
        "-Wno-unused-private-field",
        "-Wno-unused-but-set-variable",
        "-Wno-unused-function",
        "-Wno-unused-label",
        "-Wno-implicit-fallthrough",
        "-Wno-ignored-qualifiers",
        "-Wno-reorder",
        "-Wno-address-of-packed-member",
        "-Wno-unused-parameter",
        "-Wno-overloaded-virtual",
        "-Wno-extern-c-compat",
        "-fno-strict-aliasing",
        "-frtti",
        "-DANDROID_OS",
        "-UNDEBUG",
    ],

    cppflags: [
        "-fPIC",
        "-Wall",
        "-Wno-error",
        "-Os",
        "-g",
        "-Wno-unused-value",
        "-Wno-unused-variable",
        "-Wno-unused-private-field",
        "-Wno-unused-but-set-variable",
        "-Wno-unused-function",
        "-Wno-implicit-fallthrough",
        "-Wno-address-of-packed-member",
        "-Wno-ignored-qualifiers",
        "-Wno-unused-label",
        "-fno-strict-aliasing",
        "-Wno-reorder",
        "-Wno-overloaded-virtual",
        "-Wno-unused-parameter",
        "-Wno-extern-c-compat",
        "-Wno-missing-braces",
        "-Wno-missing-field-initializers",
        "-frtti",
        "-std=c++11",
        "-DANDROID_OS",
        "-UNDEBUG",
    ],

    export_include_dirs: [
        "xcore",
        "xcore/base",
        "aiq_core",
        "algos",
        "algos_camgroup",
        "hwi",
        "iq_parser",
        "iq_parser_v2",
        "uAPI",
        "uAPI/include",
        "uAPI2",
        "common",
        "include",
        "include/iq_parser",
        "include/iq_parser_v2",
        "include/iq_parser_v2/j2s",
        "include/xcore",
        "include/common",
        "include/common/mediactl",
        "include/xcore/base",
        "include/algos",
        "include/isp",
        "include/ipc_server",
        "ipc_server",
        "c_base",
    ],
}

cc_library_shared {
    name: "librkvi",
    vendor: true,
    rtti: true,
    stl: "c++_static",

    defaults: [ "rkaiq-defaults", "rkaiq-version-defaults-flags", ],

    local_include_dirs: [
        ".",
        "rk_stream/include",
        "xcore",
        "xcore/base",
        "common",
        "common/gen_mesh",
        "aiq_core",
        "algos",
        "hwi",
        "hwi/isp20",
        "hwi/isp21",
        "hwi/isp3x",
        "iq_parser",
        "iq_parser_v2",
        "uAPI",
        "uAPI/include",
        "uAPI2",
        "ipc_server",
        "include",
        "include/xcore",
        "include/xcore/base",
        "include/common",
        "include/common/mediactl",
        "include/algos",
        "include/iq_parser",
        "include/iq_parser_v2",
        "include/iq_parser_v2/j2s",
        "include/uAPI2",
        "include/ipc_server",
        "include/isp",
    ],

    shared_libs: [
        "libutils",
        "libcutils",
        "liblog",
    ],


    srcs: [
        "rk_stream/stream_cfg/IspStreamCapUnit.cpp",
        "rk_stream/stream_cfg/rk_vi_user_api_stream_cfg.cpp",
        "rk_stream/stream_cfg/RawStreamCapUnit.cpp",
        "rk_stream/stream_cfg/RawStreamProcUnit.cpp",
        "rk_stream/stream_cfg/Stream.cpp",
        "rk_stream/stream_cfg/MediaInfo.cpp",
        "common/mediactl/mediactl.c",

        // XCORE_SRC
        "xcore/xcam_common.c",
        "xcore/xcam_log.c",
        "xcore/xcam_thread.cpp",
        "xcore/xcam_buffer.cpp",
        "xcore/video_buffer.cpp",
        "xcore/v4l2_buffer_proxy.cpp",
        "xcore/v4l2_device.cpp",
        "xcore/buffer_pool.cpp",
        "xcore/poll_thread.cpp",
        "xcore/smart_buffer_priv.cpp",
        "xcore/fake_v4l2_device.cpp",
    ],

    cflags: [
        "-fPIC",
        "-Wall",
        "-Wno-error",
        "-Os",
        "-g",
        "-Wno-unused-value",
        "-Wno-unused-variable",
        "-Wno-unused-private-field",
        "-Wno-unused-but-set-variable",
        "-Wno-unused-function",
        "-Wno-unused-label",
        "-Wno-implicit-fallthrough",
        "-Wno-ignored-qualifiers",
        "-Wno-reorder",
        "-Wno-address-of-packed-member",
        "-Wno-unused-parameter",
        "-Wno-overloaded-virtual",
        "-Wno-extern-c-compat",
        "-fno-strict-aliasing",
        "-frtti",
        "-DANDROID_OS",
        "-DUSE_RAWSTREAM_LIB"
    ],

    cppflags: [
        "-fPIC",
        "-Wall",
        "-Wno-error",
        "-Os",
        "-g",
        "-Wno-unused-value",
        "-Wno-unused-variable",
        "-Wno-unused-private-field",
        "-Wno-unused-but-set-variable",
        "-Wno-unused-function",
        "-Wno-implicit-fallthrough",
        "-Wno-address-of-packed-member",
        "-Wno-ignored-qualifiers",
        "-Wno-unused-label",
        "-fno-strict-aliasing",
        "-Wno-reorder",
        "-Wno-overloaded-virtual",
        "-Wno-unused-parameter",
        "-Wno-extern-c-compat",
        "-Wno-missing-braces",
        "-Wno-missing-field-initializers",
        "-frtti",
        "-std=c++11",
        "-DANDROID_OS",
        "-DRKAIQ_ENABLE_PARSER_V1",
        "-DRKAIQ_ENABLE_CAMGROUP",
        "-DUSE_RAWSTREAM_LIB"
    ],

    export_include_dirs: [
        "xcore",
        "xcore/base",
        "uAPI2",
        "rk_stream/include",
    ],
}
